(e=>{let r,t,a,A,o,i,s,n,l,c,d,m,u=(e,r,t)=>console.log(`%c ${e} %c ${r} `,"color:#fff;background-color:#555;border-radius:3px 0 0 3px",`color:#fff;background-color:${t};border-radius:0 3px 3px 0`);u("Project","hexo-theme-akarin","#07c"),u("Author","TransparentLC","#f84"),u("Source","https://github.com/TransparentLC/hexo-theme-akarin","#4b1");class h{static imageSupport=void 0;static imageSupportTest=Object.freeze([Object.freeze({type:"webp",img:"data:image/webp;base64,UklGRhIAAABXRUJQVlA4TAYAAAAvQWxvAGs",mask:1}),Object.freeze({type:"avif",img:"data:image/avif;base64,AAAAHGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZgAAAOltZXRhAAAAAAAAACFoZGxyAAAAAAAAAABwaWN0AAAAAAAAAAAAAAAAAAAAAA5waXRtAAAAAAABAAAAHmlsb2MAAAAARAAAAQABAAAAAQAAAQ0AAAAVAAAAKGlpbmYAAAAAAAEAAAAaaW5mZQIAAAAAAQAAYXYwMUNvbG9yAAAAAGhpcHJwAAAASWlwY28AAAAUaXNwZQAAAAAAAAABAAAAAQAAAA5waXhpAAAAAAEIAAAADGF2MUOBABwAAAAAE2NvbHJuY2x4AAEADQAGgAAAABdpcG1hAAAAAAAAAAEAAQQBAoMEAAAAHW1kYXQSAAoHGAAOWAhoNTIIH/AAAQACH0A",mask:2}),Object.freeze({type:"jxl",img:"data:image/jxl;base64,/wr/BwiDBAwASyAY",mask:4})]);defaults=Object.freeze({root:null,rootMargin:"0px",threshold:0,loadingSrc:null,beforeObserve(){},afterObserve(){}});constructor(e,r){void 0===this.constructor.imageSupport&&Promise.all(this.constructor.imageSupportTest.map(e=>new Promise(r=>{let t=new Image;t.onload=t.onerror=()=>r(t.width&&e.mask),t.src=e.img}))).then(e=>{e.forEach(e=>this.constructor.imageSupport|=e),u("Next-Gen Image",this.constructor.imageSupportTest.map(e=>this.constructor.imageSupport&e.mask?e.type:"").filter(e=>e).join()||"None","#f6b")}),this.config={...this.defaults,...r},this.observer=new IntersectionObserver(e=>e.forEach(e=>e.isIntersecting&&this.load(e.target)),this.config),e.forEach(e=>{(this.config.loadingSrc?this.setSrc(e,this.config.loadingSrc):Promise.resolve()).then(()=>{this.config.beforeObserve(e),this.observer.observe(e)})})}setSrc(e,r){return new Promise(t=>{let a=new Image;a.onload=a.onerror=()=>{"img"===e.tagName.toLowerCase()?e.src=r:e.style.backgroundImage=`url(${r})`,t()},a.src=r})}load(e){let r="";this.constructor.imageSupportTest.forEach(t=>{let a=e.getAttribute(`data-src-${t.type}`);a&&this.constructor.imageSupport&t.mask&&(r=a)}),this.setSrc(e,r||e.getAttribute("data-src")).then(()=>{this.observer.unobserve(e),this.config.afterObserve(e)})}destroy(){this.observer.disconnect(),this.config=null}}(()=>{let r=e.getElementById("akarin-top");if(!r)return;let t=e.body,a=e.documentElement,A=()=>{let e=t.scrollTop,r=e+a.scrollTop,o=r/4;0!=e?t.scrollTop-=o:a.scrollTop-=o,r&&requestAnimationFrame(A)};if(r.onclick=()=>requestAnimationFrame(A),"button"===r.tagName.toLowerCase()){let e,t=()=>r.classList[2*a.scrollTop<a.clientHeight?"add":"remove"]("mdui-fab-hide");addEventListener("scroll",()=>{clearInterval(e),e=setTimeout(t,200)}),t()}})(),(r=Array.from(e.querySelectorAll("[data-dark]"))).forEach((e,t)=>{e.addEventListener("click",()=>{r.forEach((e,r)=>e.classList[t===r?"add":"remove"]("mdui-list-item-active")),switchDark(e.getAttribute("data-dark"))})}),t=localStorage.getItem("dark"),(a=r.find(e=>e.getAttribute("data-dark")===t))&&a.classList.add("mdui-list-item-active"),Array.from(e.querySelectorAll("[data-entry]")).forEach(e=>{let r=e.parentElement.previousElementSibling;r.onclick=()=>location.href=e.href,window.preload&&r.addEventListener("mouseover",()=>!_preloadedList.has(e.href)&&setTimeout(()=>preload(e.href),8*_delayOnHover))}),(A=e.createElement("button")).innerHTML='<span class="mdui-icon"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 21H8V7h11m0-2H8a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2m-3-4H4a2 2 0 0 0-2 2v14h2V3h12z"/></svg></span>',A.classList.add("mdui-btn","mdui-btn-icon","mdui-btn-dense","mdui-ripple","copy"),o=e=>navigator.clipboard.writeText(e.currentTarget.previousSibling.innerText),i=e=>"img"===e.tagName.toLowerCase()&&mediumZoom(e,{margin:16,scrollOffset:8,background:"rgba(0,0,0,.85)"}),s=e=>{let r=e.nextElementSibling&&e.nextElementSibling.classList.contains("akarin-blurred")?e.nextElementSibling:e.querySelector(".akarin-blurred");r&&(setTimeout(()=>r.classList.add("akarin-blurred-fade-out"),50),setTimeout(()=>r.style.visibility="hidden",1050))},new h(Array.from(e.querySelectorAll(".akarin-util-bg-cover[data-src]")),{beforeObserve:i,afterObserve:s}),n=e=>{new h(Array.from(e.querySelectorAll("[data-src]")),{beforeObserve:i,afterObserve:s}),Array.from(e.querySelectorAll("video,.video-container")).forEach(e=>{e.classList.add(`mdui-video-${"video"===e.tagName.toLowerCase()?"fluid":"container"}`,"mdui-img-rounded","mdui-center","mdui-hoverable")}),Array.from(l.querySelectorAll("pre.shiki")).forEach(e=>{let r=A.cloneNode(!0);r.onclick=o,e.after(r)}),Array.from(e.children).filter(e=>"IMG"===e.tagName).forEach(e=>{e.classList.add("mdui-img-fluid","mdui-img-rounded","mdui-center","mdui-hoverable","mdui-m-y-3")})},(l=e.querySelector("article"))&&n(l),c=new TextEncoder,d=new TextDecoder,m=async e=>{let r=e.currentTarget.parentNode.parentNode,t=r.querySelector("input[type=password]"),a=t.value.trim();if(!a)return;let A=(Uint8Array.frombase64||(e=>Uint8Array.from(atob(e),e=>e.charCodeAt())))(r.getAttribute("data-saltiv")),o=A.subarray(0,16),i=A.subarray(16,28),s=(Uint8Array.frombase64||(e=>Uint8Array.from(atob(e),e=>e.charCodeAt())))(r.getAttribute("data-encrypted")),l=await crypto.subtle.deriveKey({name:"PBKDF2",hash:"SHA-256",salt:o,iterations:6e5},await crypto.subtle.importKey("raw",c.encode(a),"PBKDF2",!1,["deriveKey"]),{name:"AES-GCM",length:128},!1,["decrypt"]);try{r.innerHTML=d.decode(await crypto.subtle.decrypt({name:"AES-GCM",iv:i},l,s)),n(r),Array.from(r.children).forEach(e=>r.before(e)),r.parentNode.removeChild(r)}catch{t.value="",alert("密码错误")}},Array.from(e.querySelectorAll("[data-encrypted]")).forEach(e=>{e.querySelector("button").onclick=m,e.querySelector("input[type=password]").addEventListener("keypress",e=>13===e.keyCode&&m(e))})})(document);